name: âš¡ Fast Deploy

on:
  push:
    branches:
      - main
      - claude/**

# Cancel in-progress deploys of same branch
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # Shallow clone - only latest commit (much faster)
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      # Deploy directly without any build steps
      - name: ðŸš€ Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./
          force_orphan: true  # Don't keep gh-pages history
          cname: false  # Set to your custom domain if you have one
          exclude_assets: |
            .github
            .git
            node_modules
            .gitignore
            fast-deploy.sh

      # Optional: Comment deployment URL on PR
      - name: ðŸ’¬ Comment URL
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'ðŸš€ Deployed preview: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/'
            })

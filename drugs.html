<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="theme-color" content="#030712">
<title>MedWard Drug Reference</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#030712;--bg-card:#0a0f1a;--bg-elevated:#111827;--bg-hover:#1f2937;--text:#f9fafb;--text-secondary:#9ca3af;--text-muted:#6b7280;--gold:#f59e0b;--teal:#14b8a6;--purple:#8b5cf6;--rose:#f43f5e;--emerald:#10b981;--blue:#3b82f6;--orange:#f97316;--border:rgba(255,255,255,0.08);--radius:16px;--radius-sm:10px}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh}
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}

.container{max-width:800px;margin:0 auto;padding:16px}

/* Header */
.header{display:flex;align-items:center;gap:12px;padding:16px 0;border-bottom:1px solid var(--border);margin-bottom:20px}
.back-btn{padding:10px 16px;background:var(--bg-card);border:1px solid var(--border);border-radius:10px;color:var(--text);font-size:0.85rem;text-decoration:none;transition:all 0.2s}
.back-btn:hover{border-color:var(--gold)}
.header-center{flex:1;text-align:center}
.header-center h1{font-size:1.2rem;font-weight:800;display:flex;align-items:center;justify-content:center;gap:8px}
.header-center p{font-size:0.7rem;color:var(--text-muted)}
.config-btn{width:40px;height:40px;background:var(--bg-card);border:1px solid var(--border);border-radius:10px;cursor:pointer;font-size:1rem;display:grid;place-items:center}
.config-btn:hover{border-color:var(--purple)}
.config-btn.configured{border-color:var(--emerald);color:var(--emerald)}

/* Search */
.search-box{display:flex;gap:10px;margin-bottom:24px}
.search-input{flex:1;padding:14px 16px;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-size:1rem;font-family:inherit}
.search-input:focus{outline:none;border-color:var(--purple)}
.search-btn{padding:14px 24px;background:linear-gradient(135deg,var(--purple),var(--blue));border:none;border-radius:var(--radius);color:white;font-weight:600;cursor:pointer}
.search-btn:disabled{opacity:0.5;cursor:not-allowed}

/* Drug Chips */
.section-title{font-size:0.8rem;font-weight:700;color:var(--gold);margin-bottom:12px}
.chips{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:24px}
.chip{padding:10px 16px;background:var(--bg-card);border:1px solid var(--border);border-radius:20px;font-size:0.8rem;cursor:pointer;transition:all 0.2s}
.chip:hover{border-color:var(--purple);color:var(--purple)}

/* Protocol Cards */
.protocols{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:24px}
.protocol-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:16px;cursor:pointer;transition:all 0.2s}
.protocol-card:hover{border-color:var(--gold);transform:translateY(-2px)}
.protocol-icon{font-size:1.5rem;margin-bottom:8px}
.protocol-title{font-weight:700;font-size:0.9rem}
.protocol-desc{font-size:0.7rem;color:var(--text-muted)}

/* Results */
.results{min-height:100px}
.result-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin-bottom:16px}
.result-header{padding:16px;background:linear-gradient(135deg,rgba(139,92,246,0.1),rgba(59,130,246,0.05));border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
.result-icon{width:48px;height:48px;background:linear-gradient(135deg,var(--purple),var(--blue));border-radius:12px;display:grid;place-items:center;font-size:1.5rem}
.result-title{font-size:1.1rem;font-weight:700}
.result-subtitle{font-size:0.75rem;color:var(--purple)}
.result-body{padding:16px;font-size:0.85rem;line-height:1.7;color:var(--text-secondary)}
.result-body h4{color:var(--gold);font-size:0.8rem;margin:16px 0 8px;text-transform:uppercase}
.result-body h4:first-child{margin-top:0}
.result-body ul{margin:8px 0;padding-left:20px}
.result-body li{margin-bottom:6px}
.result-body strong{color:var(--text)}
.result-body code{background:var(--bg);padding:2px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:0.8rem}
.disclaimer{text-align:center;font-size:0.7rem;color:var(--text-muted);margin-top:16px}

/* Loading */
.loading{text-align:center;padding:60px 20px}
.spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--purple);border-radius:50%;animation:spin 0.8s linear infinite;margin:0 auto 16px}
@keyframes spin{to{transform:rotate(360deg)}}

/* Error */
.error-card{background:rgba(244,63,94,0.1);border:1px solid rgba(244,63,94,0.3);border-radius:var(--radius);padding:20px;text-align:center}
.error-card h3{color:var(--rose);margin-bottom:8px}

/* Empty State */
.empty{text-align:center;padding:60px 20px;color:var(--text-muted)}
.empty-icon{font-size:3rem;margin-bottom:16px}

/* Config Modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:100;display:none;align-items:center;justify-content:center;padding:20px}
.modal.active{display:flex}
.modal-box{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);width:100%;max-width:400px;overflow:hidden}
.modal-header{padding:20px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
.modal-header h3{flex:1}
.modal-close{background:none;border:none;color:var(--text-muted);font-size:1.2rem;cursor:pointer}
.modal-body{padding:20px}
.form-label{display:block;font-size:0.8rem;color:var(--text-muted);margin-bottom:8px}
.form-input{width:100%;padding:12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:0.85rem;margin-bottom:16px}
.form-input:focus{outline:none;border-color:var(--purple)}
.form-hint{font-size:0.7rem;color:var(--text-muted);margin-top:-12px;margin-bottom:16px}
.status{font-size:0.8rem;padding:10px;border-radius:8px;margin-bottom:16px}
.status.ok{background:rgba(16,185,129,0.1);color:var(--emerald)}
.status.no{background:rgba(244,63,94,0.1);color:var(--rose)}
.btn{padding:12px 20px;border:none;border-radius:8px;font-weight:600;cursor:pointer;width:100%}
.btn-primary{background:linear-gradient(135deg,var(--purple),var(--blue));color:white}

/* AI FAB */
.ai-fab{position:fixed;bottom:24px;right:24px;width:56px;height:56px;background:linear-gradient(135deg,var(--purple),var(--blue));border:none;border-radius:50%;cursor:pointer;box-shadow:0 4px 20px rgba(139,92,246,0.4);display:grid;place-items:center;font-size:1.4rem;z-index:50}
.ai-fab:hover{transform:scale(1.1)}

/* Chat Modal */
.chat-modal{position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:200;display:none;align-items:flex-end;justify-content:center}
.chat-modal.active{display:flex}
.chat-box{width:100%;max-width:500px;max-height:80vh;background:var(--bg-card);border-radius:var(--radius) var(--radius) 0 0;display:flex;flex-direction:column}
.chat-header{padding:16px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
.chat-header h3{flex:1;font-size:1rem}
.chat-messages{flex:1;overflow-y:auto;padding:16px;min-height:200px;max-height:50vh}
.msg{margin-bottom:12px;display:flex;gap:10px}
.msg.user{flex-direction:row-reverse}
.msg-avatar{width:28px;height:28px;border-radius:6px;display:grid;place-items:center;font-size:0.8rem}
.msg.assistant .msg-avatar{background:linear-gradient(135deg,var(--purple),var(--blue))}
.msg.user .msg-avatar{background:linear-gradient(135deg,var(--gold),var(--orange))}
.msg-content{max-width:80%;padding:10px 14px;border-radius:12px;font-size:0.85rem}
.msg.assistant .msg-content{background:var(--bg-elevated);border:1px solid var(--border)}
.msg.user .msg-content{background:rgba(245,158,11,0.15);border:1px solid rgba(245,158,11,0.3)}
.msg-content h4{color:var(--gold);font-size:0.75rem;margin:8px 0 4px}
.msg-content ul{margin:4px 0;padding-left:16px;font-size:0.8rem}
.typing{display:flex;gap:4px;padding:8px}
.typing span{width:6px;height:6px;background:var(--purple);border-radius:50%;animation:bounce 1.4s infinite}
.typing span:nth-child(2){animation-delay:0.2s}
.typing span:nth-child(3){animation-delay:0.4s}
@keyframes bounce{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-6px)}}
.chat-input{padding:12px;border-top:1px solid var(--border);display:flex;gap:10px}
.chat-input textarea{flex:1;padding:10px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:0.85rem;font-family:inherit;resize:none}
.chat-input button{padding:10px 20px;background:linear-gradient(135deg,var(--purple),var(--blue));border:none;border-radius:8px;color:white;font-weight:600;cursor:pointer}

/* Toast */
.toast{position:fixed;bottom:100px;left:50%;transform:translateX(-50%) translateY(50px);background:var(--bg-elevated);border:1px solid var(--border);padding:10px 20px;border-radius:10px;font-size:0.85rem;opacity:0;transition:all 0.3s;z-index:300}
.toast.show{transform:translateX(-50%) translateY(0);opacity:1}
.toast.error{border-color:var(--rose);color:var(--rose)}

@media(max-width:600px){
  .protocols{grid-template-columns:1fr}
}
@media(min-width:601px){
  .chat-modal{align-items:center}
  .chat-box{border-radius:var(--radius);max-height:70vh}
}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <a href="https://balhaddad-sys.github.io/Final-app/index.html" class="back-btn">â† Back</a>
    <div class="header-center">
      <h1>ğŸ’Š Drug Reference</h1>
      <p>AI-Powered Clinical Information</p>
    </div>
    <button class="config-btn" id="configBtn" onclick="openConfig()" title="Configure API">âš™ï¸</button>
  </div>

  <div class="search-box">
    <input type="text" class="search-input" id="searchInput" placeholder="Search any drug..." onkeydown="if(event.key==='Enter')search()">
    <button class="search-btn" id="searchBtn" onclick="search()">Search</button>
  </div>

  <div class="section-title">ğŸ’Š Common Medications</div>
  <div class="chips">
    <div class="chip" onclick="quickSearch('Metformin')">Metformin</div>
    <div class="chip" onclick="quickSearch('Lisinopril')">Lisinopril</div>
    <div class="chip" onclick="quickSearch('Amlodipine')">Amlodipine</div>
    <div class="chip" onclick="quickSearch('Atorvastatin')">Atorvastatin</div>
    <div class="chip" onclick="quickSearch('Omeprazole')">Omeprazole</div>
    <div class="chip" onclick="quickSearch('Metoprolol')">Metoprolol</div>
    <div class="chip" onclick="quickSearch('Furosemide')">Furosemide</div>
    <div class="chip" onclick="quickSearch('Warfarin')">Warfarin</div>
    <div class="chip" onclick="quickSearch('Insulin')">Insulin</div>
    <div class="chip" onclick="quickSearch('Heparin')">Heparin</div>
    <div class="chip" onclick="quickSearch('Aspirin')">Aspirin</div>
    <div class="chip" onclick="quickSearch('Amoxicillin')">Amoxicillin</div>
  </div>

  <div class="section-title">âš¡ Quick Protocols</div>
  <div class="protocols">
    <div class="protocol-card" onclick="quickSearch('Hyperkalemia treatment protocol')">
      <div class="protocol-icon">âš¡</div>
      <div class="protocol-title">Hyperkalemia</div>
      <div class="protocol-desc">Ca gluconate, Insulin+D50, Kayexalate</div>
    </div>
    <div class="protocol-card" onclick="quickSearch('Anticoagulation reversal warfarin heparin DOAC')">
      <div class="protocol-icon">ğŸ©¸</div>
      <div class="protocol-title">Anticoag Reversal</div>
      <div class="protocol-desc">Warfarin, Heparin, DOACs</div>
    </div>
    <div class="protocol-card" onclick="quickSearch('Insulin sliding scale DKA protocol')">
      <div class="protocol-icon">ğŸ’‰</div>
      <div class="protocol-title">Insulin Protocols</div>
      <div class="protocol-desc">Sliding scale, DKA management</div>
    </div>
    <div class="protocol-card" onclick="quickSearch('Renal dose adjustments common medications CKD')">
      <div class="protocol-icon">ğŸ«˜</div>
      <div class="protocol-title">Renal Dosing</div>
      <div class="protocol-desc">CKD dose adjustments</div>
    </div>
  </div>

  <div class="results" id="results">
    <div class="empty">
      <div class="empty-icon">ğŸ”¬</div>
      <h3>Search for a Drug</h3>
      <p>Tap a medication or protocol above to get AI-powered information</p>
    </div>
  </div>
</div>

<!-- AI Chat FAB -->
<button class="ai-fab" onclick="openChat()">ğŸ¤–</button>

<!-- Config Modal -->
<div class="modal" id="configModal" onclick="if(event.target===this)closeConfig()">
  <div class="modal-box">
    <div class="modal-header">
      <h3>âš™ï¸ API Configuration</h3>
      <button class="modal-close" onclick="closeConfig()">âœ•</button>
    </div>
    <div class="modal-body">
      <label class="form-label">Google Apps Script URL</label>
      <input type="text" class="form-input" id="apiUrlInput" placeholder="https://script.google.com/macros/s/.../exec">
      <p class="form-hint">Deploy DrugCode.gs and paste the Web App URL here</p>
      
      <div class="status" id="apiStatus"></div>
      
      <button class="btn btn-primary" onclick="saveConfig()">Save Configuration</button>
    </div>
  </div>
</div>

<!-- Chat Modal -->
<div class="chat-modal" id="chatModal" onclick="if(event.target===this)closeChat()">
  <div class="chat-box">
    <div class="chat-header">
      <div style="width:36px;height:36px;background:linear-gradient(135deg,var(--purple),var(--blue));border-radius:8px;display:grid;place-items:center">ğŸ¤–</div>
      <div style="flex:1">
        <h3>Ask Claude AI</h3>
        <p style="font-size:0.7rem;color:var(--text-muted)">Clinical pharmacology assistant</p>
      </div>
      <button class="modal-close" onclick="closeChat()">âœ•</button>
    </div>
    <div class="chat-messages" id="chatMessages">
      <div class="msg assistant">
        <div class="msg-avatar">ğŸ¤–</div>
        <div class="msg-content">Hi! Ask me anything about medications, dosing, interactions, or clinical pharmacology.</div>
      </div>
    </div>
    <div class="chat-input">
      <textarea id="chatInput" placeholder="Ask a question..." rows="1" onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendChat()}"></textarea>
      <button onclick="sendChat()" id="chatSendBtn">Send</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
const STORAGE_KEY = 'medward_drug_api';
let apiUrl = '';
let chatHistory = [];
let isLoading = false;

const $ = id => document.getElementById(id);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function init() {
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) {
    try {
      const data = JSON.parse(saved);
      apiUrl = data.apiUrl || '';
    } catch(e) {}
  }
  updateConfigStatus();
}

function updateConfigStatus() {
  const btn = $('configBtn');
  const status = $('apiStatus');
  
  if (apiUrl) {
    btn.classList.add('configured');
    btn.title = 'API Configured âœ“';
    if (status) {
      status.className = 'status ok';
      status.textContent = 'âœ“ API URL configured';
    }
  } else {
    btn.classList.remove('configured');
    btn.title = 'Configure API';
    if (status) {
      status.className = 'status no';
      status.textContent = 'âš  No API URL configured';
    }
  }
  
  if ($('apiUrlInput')) {
    $('apiUrlInput').value = apiUrl;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function openConfig() {
  $('configModal').classList.add('active');
  $('apiUrlInput').value = apiUrl;
  updateConfigStatus();
}

function closeConfig() {
  $('configModal').classList.remove('active');
}

function saveConfig() {
  const url = $('apiUrlInput').value.trim();
  
  if (!url) {
    toast('Please enter API URL', true);
    return;
  }
  
  if (!url.startsWith('https://script.google.com/')) {
    toast('Invalid Google Apps Script URL', true);
    return;
  }
  
  apiUrl = url;
  localStorage.setItem(STORAGE_KEY, JSON.stringify({ apiUrl }));
  updateConfigStatus();
  closeConfig();
  toast('Configuration saved!');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SEARCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function quickSearch(query) {
  $('searchInput').value = query;
  search();
}

async function search() {
  const query = $('searchInput').value.trim();
  if (!query) return;
  
  if (!apiUrl) {
    openConfig();
    toast('Please configure API first', true);
    return;
  }
  
  const results = $('results');
  results.innerHTML = '<div class="loading"><div class="spinner"></div><p>Searching...</p></div>';
  $('searchBtn').disabled = true;
  
  try {
    const response = await fetch(apiUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify({ action: 'drugQuery', query: query })
    });
    
    const data = await response.json();
    
    if (data.error) {
      throw new Error(data.error);
    }
    
    results.innerHTML = `
      <div class="result-card">
        <div class="result-header">
          <div class="result-icon">ğŸ’Š</div>
          <div>
            <div class="result-title">${escHtml(query)}</div>
            <div class="result-subtitle">AI-Generated Information</div>
          </div>
        </div>
        <div class="result-body">${data.content}</div>
      </div>
      <p class="disclaimer">âš ï¸ Always verify with official references. AI-generated content.</p>
    `;
    
  } catch(e) {
    results.innerHTML = `
      <div class="error-card">
        <h3>âš ï¸ Error</h3>
        <p>${escHtml(e.message)}</p>
      </div>
    `;
  } finally {
    $('searchBtn').disabled = false;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHAT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function openChat() {
  if (!apiUrl) {
    openConfig();
    toast('Please configure API first', true);
    return;
  }
  $('chatModal').classList.add('active');
}

function closeChat() {
  $('chatModal').classList.remove('active');
}

async function sendChat() {
  const input = $('chatInput');
  const msg = input.value.trim();
  
  if (!msg || isLoading) return;
  
  isLoading = true;
  $('chatSendBtn').disabled = true;
  input.value = '';
  
  addMsg('user', msg);
  const loadingId = addLoading();
  
  try {
    const response = await fetch(apiUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify({ 
        action: 'chat', 
        message: msg,
        history: chatHistory
      })
    });
    
    const data = await response.json();
    
    removeMsg(loadingId);
    
    if (data.error) {
      addMsg('assistant', `<span style="color:var(--rose)">Error: ${escHtml(data.error)}</span>`);
    } else {
      addMsg('assistant', data.content);
      chatHistory.push({ role: 'user', content: msg });
      chatHistory.push({ role: 'assistant', content: data.content });
    }
    
  } catch(e) {
    removeMsg(loadingId);
    addMsg('assistant', `<span style="color:var(--rose)">Error: ${escHtml(e.message)}</span>`);
  } finally {
    isLoading = false;
    $('chatSendBtn').disabled = false;
  }
}

function addMsg(role, content) {
  const container = $('chatMessages');
  const id = 'msg_' + Date.now();
  const avatar = role === 'user' ? 'ğŸ‘¤' : 'ğŸ¤–';
  const html = role === 'assistant' ? content : escHtml(content);
  
  container.insertAdjacentHTML('beforeend', `
    <div class="msg ${role}" id="${id}">
      <div class="msg-avatar">${avatar}</div>
      <div class="msg-content">${html}</div>
    </div>
  `);
  container.scrollTop = container.scrollHeight;
  return id;
}

function addLoading() {
  const container = $('chatMessages');
  const id = 'loading_' + Date.now();
  container.insertAdjacentHTML('beforeend', `
    <div class="msg assistant" id="${id}">
      <div class="msg-avatar">ğŸ¤–</div>
      <div class="msg-content"><div class="typing"><span></span><span></span><span></span></div></div>
    </div>
  `);
  container.scrollTop = container.scrollHeight;
  return id;
}

function removeMsg(id) {
  const el = $(id);
  if (el) el.remove();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function escHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

function toast(msg, isError) {
  const t = $('toast');
  t.textContent = msg;
  t.className = 'toast show' + (isError ? ' error' : '');
  setTimeout(() => t.className = 'toast', 3000);
}

// Init
init();
</script>

</body>
</html>
